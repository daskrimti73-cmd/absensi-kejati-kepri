<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Absensi Mobile - Kejaksaan Tinggi Kepulauan Riau</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #2c2c2c; min-height: 100vh; padding: 15px; color: #333; }
        
        .dashboard-container { max-width: 1400px; margin: 0 auto; }
        
        /* Top Summary Cards */
        .top-summary { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .summary-card { display: flex; align-items: center; gap: 15px; padding: 15px 25px; border-radius: 8px; min-width: 180px; }
        .summary-card.pegawai { background: #8B4513; }
        .summary-card.hari-kerja { background: #6B8E23; }
        .summary-card.check-in { background: #2E8B57; }
        .summary-card.bidang { background: #B8860B; }
        .summary-card .card-label { background: rgba(0,0,0,0.3); color: white; padding: 8px 12px; border-radius: 5px; font-size: 11px; font-weight: 600; text-transform: uppercase; }
        .summary-card .card-value { font-size: 32px; font-weight: 700; color: white; }
        .summary-card .card-icon { font-size: 28px; opacity: 0.8; }
        
        /* Filter Section */
        .filter-section { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; background: rgba(255,255,255,0.1); padding: 15px 20px; border-radius: 10px; }
        .filter-group { display: flex; flex-direction: column; gap: 5px; }
        .filter-group label { font-weight: 500; color: #fff; font-size: 12px; }
        .filter-group select { padding: 10px 15px; font-size: 14px; border: none; border-radius: 6px; background: white; cursor: pointer; min-width: 140px; }
        
        /* Main Content Grid */
        .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        
        /* Cards */
        .card { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
        .card-title { font-size: 14px; font-weight: 600; color: #333; text-transform: uppercase; }
        
        /* Bidang Pegawai Section */
        .bidang-section { display: flex; gap: 20px; }
        .bidang-chart-container { flex: 1; height: 250px; }
        
        /* Persentase Section */
        .persentase-container { display: flex; gap: 30px; justify-content: center; align-items: center; }
        .donut-wrapper { text-align: center; position: relative; }
        .donut-chart { width: 180px; height: 180px; }
        .donut-center-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .donut-center-text .percentage { font-size: 24px; font-weight: 700; color: #333; }
        .donut-center-text .label { font-size: 10px; color: #666; }
        
        /* Legend Items */
        .legend-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 15px; }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 11px; }
        .legend-color { width: 12px; height: 12px; border-radius: 3px; }
        
        /* Keterangan Section */
        .keterangan-box { background: #f8f9fa; border-radius: 8px; padding: 15px; margin-left: 20px; }
        .keterangan-title { font-size: 12px; font-weight: 600; color: #666; margin-bottom: 10px; }
        .keterangan-item { display: flex; justify-content: space-between; font-size: 11px; padding: 3px 0; }
        
        /* Bidang Cards Grid */
        .bidang-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px; }
        .bidang-card { background: white; border-radius: 10px; padding: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .bidang-card-header { font-size: 13px; font-weight: 600; color: #333; margin-bottom: 10px; text-align: center; border-bottom: 2px solid #B8860B; padding-bottom: 8px; }
        .bidang-stats { display: flex; flex-direction: column; gap: 4px; font-size: 10px; margin-bottom: 10px; }
        .bidang-stat-row { display: flex; justify-content: space-between; align-items: center; }
        .bidang-stat-row .stat-label { color: #666; }
        .bidang-stat-row .stat-value { font-weight: 600; padding: 2px 8px; border-radius: 3px; font-size: 9px; }
        .bidang-stat-row .stat-value.tidak-absen { background: #dc3545; color: white; }
        .bidang-stat-row .stat-value.cuti { background: #ffc107; color: #333; }
        .bidang-stat-row .stat-value.ijin { background: #20c997; color: white; }
        .bidang-stat-row .stat-value.sakit { background: #fd7e14; color: white; }
        .bidang-stat-row .stat-value.undangan { background: #6f42c1; color: white; }
        .bidang-stat-row .stat-value.dinas { background: #17a2b8; color: white; }
        .bidang-stat-row .stat-value.wfo { background: #28a745; color: white; }
        .bidang-chart { height: 120px; margin-top: 10px; }
        .bidang-chart-legend { display: flex; flex-wrap: wrap; gap: 5px; margin-top: 8px; justify-content: center; }
        .bidang-chart-legend span { font-size: 8px; color: #666; }
        
        /* Table Section */
        .table-section { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-top: 20px; }
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; }
        th, td { padding: 10px 8px; text-align: center; border: 1px solid #e0e0e0; }
        th { background: #3d3d3d; color: white; font-weight: 600; position: sticky; top: 0; }
        tr:nth-child(even) { background: #f8f9fa; }
        tr:hover { background: #e9ecef; }
        .weekend-row { background: #ffe6e6 !important; color: #999; }
        
        /* Footer */
        .footer { text-align: center; margin-top: 20px; padding: 15px; color: #999; font-size: 12px; }
        
        /* Responsive */
        @media (max-width: 1200px) { 
            .bidang-grid { grid-template-columns: repeat(2, 1fr); } 
            .main-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) { 
            .top-summary { flex-direction: column; align-items: center; }
            .summary-card { width: 100%; justify-content: center; }
            .bidang-grid { grid-template-columns: 1fr; }
            .persentase-container { flex-direction: column; }
            .filter-section { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Top Summary Cards -->
        <div class="top-summary">
            <div class="summary-card pegawai">
                <span class="card-label">Total<br>Pegawai</span>
                <span class="card-value" id="statPegawai">142</span>
                <span class="card-icon">üë•</span>
            </div>
            <div class="summary-card hari-kerja">
                <span class="card-label">Hari<br>Kerja</span>
                <span class="card-value" id="statHariKerja">21</span>
                <span class="card-icon">üìÖ</span>
            </div>
            <div class="summary-card check-in">
                <span class="card-label">Check<br>In</span>
                <span class="card-value"><span id="statCheckIn">2965</span>/<span id="statTotalCheckIn">2982</span></span>
                <span class="card-icon">‚úÖ</span>
            </div>
            <div class="summary-card bidang">
                <span class="card-label">Total<br>Bidang</span>
                <span class="card-value" id="statBidang">9</span>
                <span class="card-icon">üè¢</span>
            </div>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <div class="filter-group">
                <label for="bulanFilter">üìÖ Pilih Bulan:</label>
                <select id="bulanFilter" onchange="updateChart()">
                    <option value="januari">Januari</option>
                    <option value="februari">Februari</option>
                    <option value="maret">Maret</option>
                    <option value="april">April</option>
                    <option value="mei">Mei</option>
                    <option value="juni">Juni</option>
                    <option value="juli">Juli</option>
                    <option value="agustus">Agustus</option>
                    <option value="september">September</option>
                    <option value="oktober">Oktober</option>
                    <option value="november">November</option>
                    <option value="desember" selected>Desember</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="tahunFilter">üìÜ Pilih Tahun:</label>
                <select id="tahunFilter" onchange="updateChart()">
                    <option value="2025" selected>2025</option>
                    <option value="2026">2026</option>
                </select>
            </div>
        </div>

        <!-- Main Content - Bidang Pegawai & Persentase -->
        <div class="main-grid">
            <!-- Bidang Pegawai Card -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Bidang Pegawai</span>
                </div>
                <div class="bidang-chart-container">
                    <canvas id="bidangChart"></canvas>
                </div>
            </div>
            
            <!-- Persentase Kehadiran Card -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Persentase Kehadiran Keseluruhan</span>
                </div>
                <div class="persentase-container">
                    <div class="donut-wrapper">
                        <canvas id="kehadiranDonutChart" class="donut-chart"></canvas>
                    </div>
                    <div class="donut-wrapper">
                        <canvas id="absenDonutChart" class="donut-chart"></canvas>
                    </div>
                    <div class="keterangan-box">
                        <div class="keterangan-title">Tanpa Keterangan</div>
                        <div class="keterangan-item">
                            <span id="tanpaKeteranganPersen">0.57%</span>
                        </div>
                    </div>
                </div>
                <div class="legend-grid">
                    <div class="legend-item"><div class="legend-color" style="background: #28a745;"></div><span>WFO</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #17a2b8;"></div><span>DINAS LUAR</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #6f42c1;"></div><span>UNDANGAN</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #fd7e14;"></div><span>SAKIT</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #20c997;"></div><span>IJIN</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #ffc107;"></div><span>CUTI</span></div>
                    <div class="legend-item"><div class="legend-color" style="background: #dc3545;"></div><span>TIDAK ABSEN</span></div>
                </div>
            </div>
        </div>
        
        <!-- Pembinaan Summary Card -->
        <div class="card" style="margin-bottom: 20px;">
            <div class="card-header">
                <span class="card-title">Ringkasan Kehadiran Per Kategori</span>
            </div>
            <div style="height: 200px;">
                <canvas id="pembinaanChart"></canvas>
            </div>
        </div>

        <!-- Bidang Cards Grid -->
        <div class="bidang-grid">
            <!-- Tata Usaha -->
            <div class="bidang-card">
                <div class="bidang-card-header">Tata Usaha</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="tu-tidakAbsen">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="tu-cuti">6.94%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="tu-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="tu-sakit">0.46%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="tu-undangan">1.32%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="tu-dinas">5.79%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="tu-wfo">83.33%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-tu"></canvas></div>
            </div>
            
            <!-- Tindak Pidana Khusus -->
            <div class="bidang-card">
                <div class="bidang-card-header">Tindak Pidana Khusus</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="pidsus-tidakAbsen">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="pidsus-cuti">5.24%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="pidsus-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="pidsus-sakit">0.67%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="pidsus-undangan">2.38%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="pidsus-dinas">17.80%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="pidsus-wfo">74.00%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-pidsus"></canvas></div>
            </div>
            
            <!-- Tindak Pidana Umum -->
            <div class="bidang-card">
                <div class="bidang-card-header">Tindak Pidana Umum</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="pidum-tidakAbsen">1.70%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="pidum-cuti">2.01%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="pidum-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="pidum-sakit">0.75%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="pidum-undangan">4.05%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="pidum-dinas">24.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="pidum-wfo">65.50%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-pidum"></canvas></div>
            </div>
            
            <!-- Intelijen -->
            <div class="bidang-card">
                <div class="bidang-card-header">Intelijen</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="intel-tidakAbsen">0.52%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="intel-cuti">3.17%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="intel-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="intel-sakit">0.51%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="intel-undangan">5.67%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="intel-dinas">12.70%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="intel-wfo">76.51%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-intel"></canvas></div>
            </div>
            
            <!-- Pengawasan -->
            <div class="bidang-card">
                <div class="bidang-card-header">Pengawasan</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="was-tidakAbsen">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="was-cuti">4.40%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="was-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="was-sakit">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="was-undangan">5.67%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="was-dinas">21.60%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="was-wfo">61.17%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-was"></canvas></div>
            </div>
            
            <!-- Perdata dan Tata Usaha Negara -->
            <div class="bidang-card">
                <div class="bidang-card-header">Perdata dan TUN</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="datun-tidakAbsen">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="datun-cuti">3.79%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="datun-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="datun-sakit">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="datun-undangan">1.19%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="datun-dinas">17.26%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="datun-wfo">78.06%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-datun"></canvas></div>
            </div>
            
            <!-- Pemulihan Aset -->
            <div class="bidang-card">
                <div class="bidang-card-header">Pemulihan Aset</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="aset-tidakAbsen">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="aset-cuti">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="aset-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="aset-sakit">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="aset-undangan">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="aset-dinas">39.05%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="aset-wfo">60.95%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-aset"></canvas></div>
            </div>
            
            <!-- Koordinator -->
            <div class="bidang-card">
                <div class="bidang-card-header">Koordinator</div>
                <div class="bidang-stats">
                    <div class="bidang-stat-row"><span class="stat-label">TIDAK ABSEN</span><span class="stat-value tidak-absen" id="kor-tidakAbsen">1.19%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">CUTI</span><span class="stat-value cuti" id="kor-cuti">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">IJIN</span><span class="stat-value ijin" id="kor-ijin">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">SAKIT</span><span class="stat-value sakit" id="kor-sakit">0.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">UNDANGAN</span><span class="stat-value undangan" id="kor-undangan">1.19%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">DINAS LUAR</span><span class="stat-value dinas" id="kor-dinas">30.00%</span></div>
                    <div class="bidang-stat-row"><span class="stat-label">WFO</span><span class="stat-value wfo" id="kor-wfo">65.00%</span></div>
                </div>
                <div class="bidang-chart"><canvas id="chart-kor"></canvas></div>
            </div>
        </div>

        <!-- Table Section -->
        <div class="table-section">
            <h3 id="tableTitle" style="margin-bottom: 15px; color: #333;">üìã Detail Data Harian - Desember 2025</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Tgl</th>
                            <th>Hari</th>
                            <th>WFO</th>
                            <th>Dinas Luar</th>
                            <th>Undangan</th>
                            <th>Sakit</th>
                            <th>Ijin</th>
                            <th>Cuti</th>
                            <th>Tidak Absen</th>
                            <th>Total Aktif</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            <p>¬© 2025 Kejaksaan Tinggi Kepulauan Riau - Sistem Absensi Mobile</p>
            <p>Data: 122-151 Pegawai | Periode: Mei - Desember 2025</p>
        </div>
    </div>

    <script>
        // DATA ABSENSI - Diorganisir per TAHUN dan BULAN
        const dataAbsensi = {
            2025: {
                mei: { totalPegawai: 122, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Libur','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Libur','Libur','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Libur','Libur','Sabtu'], isWeekend: [true,false,true,true,false,false,false,false,false,true,true,true,true,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,true,true,true], wfo: [0,92,0,0,98,97,96,88,92,0,0,0,0,92,95,81,0,0,92,91,98,92,101,0,0,104,101,100,0,0,0], dinasLuar: [0,8,0,0,6,6,10,15,10,0,0,0,0,12,12,15,0,0,12,15,8,16,6,0,0,1,1,3,0,0,0], undangan: [0,8,0,0,3,4,2,4,4,0,0,0,0,5,2,13,0,0,4,4,4,2,3,0,0,2,5,4,0,0,0], sakit: [0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0], ijin: [0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [0,1,0,0,4,4,4,4,5,0,0,0,0,2,2,2,0,0,2,2,1,1,1,0,0,3,3,3,0,0,0], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                juni: { totalPegawai: 149, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30], hari: ['Minggu','Senin','Selasa','Rabu','Kamis','Libur','Sabtu','Minggu','Libur','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Libur','Sabtu','Minggu','Senin'], isWeekend: [true,false,false,false,false,true,true,true,true,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,true,true,true,false], wfo: [0,100,103,106,117,0,0,0,0,123,126,125,126,0,0,117,118,114,107,106,0,0,122,119,105,110,0,0,0,122], dinasLuar: [0,6,4,5,1,0,0,0,0,3,2,0,3,0,0,9,8,17,21,23,0,0,5,8,13,12,0,0,0,10], undangan: [0,4,3,2,7,0,0,0,0,6,5,5,3,0,0,2,5,5,6,8,0,0,2,4,10,10,0,0,0,1], sakit: [0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,2,1,0,1,0,0,0,1,0,2,1,0,0,0,0], ijin: [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1], cuti: [0,5,5,6,7,0,0,0,0,5,5,5,5,0,0,4,4,1,2,2,0,0,6,6,6,6,0,0,0,3], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                juli: { totalPegawai: 151, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis'], isWeekend: [false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false], wfo: [120,115,107,112,0,0,120,113,123,125,118,0,0,122,126,125,128,133,0,0,126,127,122,121,117,0,0,130,119,128,125], dinasLuar: [9,11,18,11,0,0,5,11,1,4,5,0,0,5,9,8,4,2,0,0,0,0,2,7,7,0,0,7,7,2,0], undangan: [1,3,6,7,0,0,2,3,4,4,9,0,0,7,1,4,4,1,0,0,2,3,3,2,1,0,0,1,1,8,2], sakit: [0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0], ijin: [0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0], cuti: [4,4,3,3,0,0,6,6,6,4,4,0,0,2,0,0,0,0,0,0,1,1,2,1,1,0,0,1,1,1,1], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                agustus: { totalPegawai: 142, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Libur','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu'], isWeekend: [false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,true,false,false,false,false,true,true,false,false,false,false,false,true,true], wfo: [121,0,0,108,111,117,99,115,0,0,115,125,126,111,109,0,0,0,123,109,112,111,0,0,119,124,117,105,118,0,0], dinasLuar: [5,0,0,26,23,17,35,19,0,0,17,9,8,23,23,0,0,0,11,25,24,25,0,0,15,10,17,29,17,0,0], undangan: [4,0,0,5,5,4,3,1,0,0,3,2,1,2,3,0,0,0,2,2,2,3,0,0,1,3,3,5,5,0,0], sakit: [2,0,0,2,2,2,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,1,1,0,2,2,0,0], ijin: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [3,0,0,4,4,4,4,4,0,0,7,6,6,6,6,0,0,0,6,6,6,6,0,0,6,4,4,4,4,0,0], tidakAbsen: [7,0,0,5,5,6,9,9,0,0,8,8,9,8,6,0,0,0,8,8,6,4,0,0,8,8,9,5,4,0,0] },
                september: { totalPegawai: 150, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30], hari: ['Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa'], isWeekend: [false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false], wfo: [138,134,128,123,0,0,0,108,108,108,105,104,0,0,96,98,101,89,121,0,0,97,91,108,117,124,0,0,117,113], dinasLuar: [0,0,10,11,0,0,0,20,18,13,21,21,0,0,35,38,33,47,16,0,0,35,36,18,19,11,0,0,18,21], undangan: [1,4,1,3,0,0,0,0,2,8,6,4,0,0,2,1,3,1,0,0,0,6,11,13,1,1,0,0,3,4], sakit: [0,1,0,0,0,0,0,3,3,2,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1], ijin: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0], cuti: [3,3,3,5,0,0,0,11,10,10,9,11,0,0,7,4,4,4,4,0,0,3,2,2,3,4,0,0,3,2], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                oktober: { totalPegawai: 147, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat'], isWeekend: [false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false], wfo: [113,105,102,0,0,110,109,110,103,106,0,0,121,127,125,105,101,0,0,132,128,124,119,119,0,0,127,127,109,107,125], dinasLuar: [21,29,29,0,0,22,25,25,34,30,0,0,15,9,10,29,30,0,0,0,4,8,16,16,0,0,5,5,23,24,2], undangan: [3,3,4,0,0,3,1,2,0,0,0,0,1,1,2,1,4,0,0,3,3,3,0,0,0,0,2,2,2,4,5], sakit: [0,0,2,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1], ijin: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1], cuti: [2,2,2,0,0,3,3,2,2,2,0,0,2,2,2,4,4,0,0,4,4,4,4,4,0,0,4,4,4,4,5], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                november: { totalPegawai: 143, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30], hari: ['Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu'], isWeekend: [true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true], wfo: [0,0,124,119,106,100,105,0,0,120,122,111,106,107,0,0,120,128,109,92,99,0,0,110,113,107,81,92,0,0], dinasLuar: [0,0,13,17,26,36,29,0,0,13,19,23,30,26,0,0,14,8,25,44,35,0,0,25,19,28,50,44,0,0], undangan: [0,0,0,2,5,1,3,0,0,3,0,3,2,4,0,0,3,1,3,1,3,0,0,2,4,2,1,1,0,0], sakit: [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,0,4,2,0,0], ijin: [0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [0,0,2,2,3,3,3,0,0,4,2,2,2,2,0,0,3,2,2,2,1,0,0,2,2,2,2,2,0,0], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                desember: { totalPegawai: 142, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Libur','Libur','Sabtu','Minggu','Senin','Selasa','Rabu'], isWeekend: [false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,true,true,true,true,false,false,false], wfo: [121,117,121,124,124,0,0,121,118,94,96,97,0,0,60,56,124,105,101,0,0,111,113,111,0,0,0,0,126,125,119], dinasLuar: [11,17,18,10,11,0,0,9,14,36,36,31,0,0,72,75,9,18,16,0,0,2,0,2,0,0,0,0,0,0,6], undangan: [8,5,1,4,4,0,0,5,3,5,2,5,0,0,6,5,3,5,4,0,0,3,1,2,0,0,0,0,1,1,1], sakit: [0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,2,0,2,4,0,0,1,1,1,0,0,0,0,1,2,0], ijin: [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [2,2,2,3,3,0,0,6,5,6,7,9,0,0,4,4,6,11,17,0,0,25,25,26,0,0,0,0,14,14,14], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] }
            },
            2026: { }
        };

        // Data Bidang Pegawai
        const dataBidang = {
            labels: ['Pembinaan', 'Tata Usaha', 'Pidsus', 'Pidum', 'Pengawasan', 'Datun', 'Intel', 'Koordinator'],
            data: [33, 22, 19, 18, 15, 15, 4, 8],
            colors: ['#5DADE2', '#F39C12', '#E74C3C', '#9B59B6', '#1ABC9C', '#3498DB', '#E67E22', '#95A5A6']
        };

        const bulanNama = { januari: 'JANUARI', februari: 'FEBRUARI', maret: 'MARET', april: 'APRIL', mei: 'MEI', juni: 'JUNI', juli: 'JULI', agustus: 'AGUSTUS', september: 'SEPTEMBER', oktober: 'OKTOBER', november: 'NOVEMBER', desember: 'DESEMBER' };

        let chartInstance, bidangChartInstance, kehadiranDonutInstance, absenDonutInstance, pembinaanChartInstance;
        let bidangCharts = {};

        const datasetConfig = { wfo: { label: 'WFO', color: '#28a745', border: '#1e7e34' }, dinasLuar: { label: 'Dinas Luar', color: '#17a2b8', border: '#138496' }, undangan: { label: 'Undangan', color: '#6f42c1', border: '#5a32a3' }, sakit: { label: 'Sakit', color: '#fd7e14', border: '#e0a800' }, ijin: { label: 'Ijin', color: '#20c997', border: '#1aa179' }, cuti: { label: 'Cuti', color: '#ffc107', border: '#d4a100' }, tidakAbsen: { label: 'Tidak Absen', color: '#dc3545', border: '#c82333' } };

        function getSelectedData() { const bulan = document.getElementById('bulanFilter').value; const tahun = document.getElementById('tahunFilter').value; if (dataAbsensi[tahun] && dataAbsensi[tahun][bulan]) { return dataAbsensi[tahun][bulan]; } return null; }

        function initCharts() {
            initBidangChart();
            initKehadiranDonutChart();
            initAbsenDonutChart();
            initPembinaanChart();
            initBidangSmallCharts();
            updateStats();
            updateTable();
        }
        
        function initBidangChart() {
            const ctx = document.getElementById('bidangChart').getContext('2d');
            bidangChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: dataBidang.labels,
                    datasets: [{
                        data: dataBidang.data,
                        backgroundColor: dataBidang.colors,
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { beginAtZero: true, grid: { display: false } },
                        y: { grid: { display: false } }
                    }
                }
            });
        }
        
        function initKehadiranDonutChart() {
            const ctx = document.getElementById('kehadiranDonutChart').getContext('2d');
            const data = getSelectedData() || dataAbsensi[2025].desember;
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            const total = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan) + sum(data.sakit) + sum(data.ijin) + sum(data.cuti) + sum(data.tidakAbsen);
            
            kehadiranDonutInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['WFO', 'Dinas Luar', 'Undangan', 'Sakit', 'Ijin', 'Cuti', 'Tidak Absen'],
                    datasets: [{
                        data: [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)],
                        backgroundColor: ['#28a745', '#17a2b8', '#6f42c1', '#fd7e14', '#20c997', '#ffc107', '#dc3545'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    cutout: '65%',
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function initAbsenDonutChart() {
            const ctx = document.getElementById('absenDonutChart').getContext('2d');
            const data = getSelectedData() || dataAbsensi[2025].desember;
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            const totalAbsen = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan);
            const totalTidakAbsen = sum(data.sakit) + sum(data.ijin) + sum(data.cuti) + sum(data.tidakAbsen);
            
            absenDonutInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Absen', 'Tidak Absen'],
                    datasets: [{
                        data: [totalAbsen, totalTidakAbsen],
                        backgroundColor: ['#28a745', '#e9ecef'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    cutout: '65%',
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function initPembinaanChart() {
            const ctx = document.getElementById('pembinaanChart').getContext('2d');
            const data = getSelectedData() || dataAbsensi[2025].desember;
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            pembinaanChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['WFO', 'Dinas Luar', 'Undangan', 'Sakit', 'Ijin', 'Cuti', 'Tidak Absen'],
                    datasets: [{
                        label: 'Jumlah',
                        data: [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)],
                        backgroundColor: ['#28a745', '#17a2b8', '#6f42c1', '#fd7e14', '#20c997', '#ffc107', '#dc3545'],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false } },
                        y: { beginAtZero: true, grid: { color: '#f0f0f0' } }
                    }
                }
            });
        }
        
        function initBidangSmallCharts() {
            const bidangIds = ['tu', 'pidsus', 'pidum', 'intel', 'was', 'datun', 'aset', 'kor'];
            const bidangNames = ['Tata Usaha', 'Tindak Pidana Khusus', 'Tindak Pidana Umum', 'Intelijen', 'Pengawasan', 'Perdata TUN', 'Pemulihan Aset', 'Koordinator'];
            
            bidangIds.forEach((id, index) => {
                const ctx = document.getElementById(`chart-${id}`);
                if (ctx) {
                    bidangCharts[id] = new Chart(ctx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['WFO', 'DL', 'UND', 'S', 'I', 'C', 'TA'],
                            datasets: [{
                                data: [80 + Math.random() * 20, 10 + Math.random() * 30, 2 + Math.random() * 5, Math.random() * 2, 0, 2 + Math.random() * 5, Math.random() * 2],
                                backgroundColor: ['#28a745', '#17a2b8', '#6f42c1', '#fd7e14', '#20c997', '#ffc107', '#dc3545'],
                                borderRadius: 3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                x: { grid: { display: false }, ticks: { font: { size: 8 } } },
                                y: { beginAtZero: true, grid: { color: '#f0f0f0' }, ticks: { font: { size: 8 } } }
                            }
                        }
                    });
                }
            });
        }

        function updateChart() {
            const bulan = document.getElementById('bulanFilter').value;
            const tahun = document.getElementById('tahunFilter').value;
            const data = getSelectedData();
            
            if (!data) {
                updateStatsEmpty();
                updateTableEmpty(bulan, tahun);
                return;
            }
            
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            // Update Kehadiran Donut
            if (kehadiranDonutInstance) {
                kehadiranDonutInstance.data.datasets[0].data = [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)];
                kehadiranDonutInstance.update();
            }
            
            // Update Absen Donut
            if (absenDonutInstance) {
                const totalAbsen = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan);
                const totalTidakAbsen = sum(data.sakit) + sum(data.ijin) + sum(data.cuti) + sum(data.tidakAbsen);
                absenDonutInstance.data.datasets[0].data = [totalAbsen, totalTidakAbsen];
                absenDonutInstance.update();
            }
            
            // Update Pembinaan Chart
            if (pembinaanChartInstance) {
                pembinaanChartInstance.data.datasets[0].data = [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)];
                pembinaanChartInstance.update();
            }
            
            updateStats();
            updateTable();
        }

        function updateStats() {
            const data = getSelectedData();
            if (!data) { updateStatsEmpty(); return; }
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            document.getElementById('statPegawai').textContent = data.totalPegawai;
            
            // Calculate working days
            const workingDays = data.isWeekend.filter(w => !w).length;
            document.getElementById('statHariKerja').textContent = workingDays;
            
            // Calculate check-in stats
            const totalCheckIn = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan);
            const expectedCheckIn = data.totalPegawai * workingDays;
            document.getElementById('statCheckIn').textContent = totalCheckIn.toLocaleString();
            document.getElementById('statTotalCheckIn').textContent = expectedCheckIn.toLocaleString();
        }

        function updateStatsEmpty() {
            document.getElementById('statPegawai').textContent = '-';
            document.getElementById('statHariKerja').textContent = '-';
            document.getElementById('statCheckIn').textContent = '-';
            document.getElementById('statTotalCheckIn').textContent = '-';
        }

        function updateTableEmpty(bulan, tahun) {
            const tableBody = document.getElementById('tableBody');
            document.getElementById('tableTitle').innerHTML = 'üìã Detail Data Harian - ' + bulanNama[bulan] + ' ' + tahun;
            tableBody.innerHTML = '<tr><td colspan="10" style="text-align:center;padding:30px;color:#999;">Data tidak tersedia untuk periode ini</td></tr>';
        }

        function updateTable() {
            const bulan = document.getElementById('bulanFilter').value;
            const tahun = document.getElementById('tahunFilter').value;
            const data = getSelectedData();
            const tableBody = document.getElementById('tableBody');
            document.getElementById('tableTitle').innerHTML = 'üìã Detail Data Harian - ' + bulanNama[bulan] + ' ' + tahun;
            
            if (!data) {
                tableBody.innerHTML = '<tr><td colspan="10" style="text-align:center;padding:30px;color:#999;">Data tidak tersedia untuk periode ini</td></tr>';
                return;
            }
            
            let html = '';
            for (let i = 0; i < data.labels.length; i++) {
                const isWeekend = data.isWeekend[i];
                const rowClass = isWeekend ? 'weekend-row' : '';
                const totalAktif = data.wfo[i] + data.dinasLuar[i] + data.undangan[i];
                html += `<tr class="${rowClass}">
                    <td><strong>${data.labels[i]}</strong></td>
                    <td>${data.hari[i]}</td>
                    <td>${data.wfo[i]}</td>
                    <td>${data.dinasLuar[i]}</td>
                    <td>${data.undangan[i]}</td>
                    <td>${data.sakit[i]}</td>
                    <td>${data.ijin[i]}</td>
                    <td>${data.cuti[i]}</td>
                    <td>${data.tidakAbsen[i]}</td>
                    <td><strong>${totalAktif}</strong></td>
                </tr>`;
            }
            tableBody.innerHTML = html;
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', initCharts);
    </script>
</body>
</html>
