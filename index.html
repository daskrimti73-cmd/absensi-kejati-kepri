<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Dashboard Absensi Mobile - Kejaksaan Tinggi Kepulauan Riau</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        html { font-size: 16px; }
        
        body { 
            font-family: 'Poppins', sans-serif; 
            background: #f5f7fa; 
            min-height: 100vh; 
            padding: 20px; 
            color: #333; 
        }
        
        .dashboard-container { 
            max-width: 100%; 
            margin: 0 auto; 
            width: 100%;
            padding: 0 15px;
        }
        
        /* Main Title */
        .dashboard-title {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: none;
        }
        
        /* Top Summary Cards */
        .top-summary { 
            display: flex; 
            flex-wrap: wrap;
            gap: 15px; 
            margin-bottom: 20px; 
            justify-content: center;
        }
        
        .summary-card { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            padding: 18px 24px; 
            border-radius: 12px; 
            background: white;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            flex: 1;
            min-width: 220px;
            max-width: 300px;
            border-left: 4px solid #4A90A4;
            transition: box-shadow 0.3s;
        }
        .summary-card:hover { box-shadow: 0 4px 20px rgba(0,0,0,0.12); }
        .summary-card.hari-kerja { border-left-color: #5B9A8B; }
        .summary-card.check-in { border-left-color: #C1946A; }
        .summary-card.bidang { border-left-color: #7C9CB5; }
        
        .summary-card .card-label { 
            background: #f0f4f8; 
            color: #4A5568; 
            padding: 6px 12px; 
            border-radius: 6px; 
            font-size: 0.7rem; 
            font-weight: 600; 
            text-transform: uppercase; 
            line-height: 1.2;
            text-align: center;
            min-width: 55px;
        }
        .summary-card .card-value { 
            font-size: 1.6rem; 
            font-weight: 700; 
            color: #2D3748; 
        }
        .summary-card .card-icon { 
            font-size: 1.4rem; 
            margin-left: auto;
            opacity: 0.7;
        }
        
        /* Filter Section */
        .filter-section { 
            display: flex; 
            gap: 20px; 
            margin-bottom: 15px; 
            justify-content: center; 
            background: white; 
            padding: 12px 20px; 
            border-radius: 10px; 
            align-items: center;
            flex-wrap: wrap;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        .filter-group { display: flex; align-items: center; gap: 8px; }
        .filter-group label { font-weight: 600; color: #2c3e50; font-size: 0.9rem; }
        .filter-group select { 
            padding: 10px 18px; 
            font-size: 0.9rem; 
            border: 2px solid #e0e0e0; 
            border-radius: 8px; 
            background: white; 
            cursor: pointer; 
            min-width: 130px;
            font-family: 'Poppins', sans-serif;
            transition: border-color 0.3s;
        }
        .filter-group select:hover { border-color: #4A90A4; }
        .filter-group select:focus { outline: none; border-color: #4A90A4; }
        
        /* Main Content - 3 Column Grid */
        .main-grid { 
            display: grid; 
            grid-template-columns: 1fr 2fr 1fr; 
            gap: 15px; 
            margin-bottom: 10px; 
        }
        
        /* Cards */
        .card { 
            background: white; 
            border-radius: 12px; 
            padding: 18px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); 
            border: 1px solid #eee;
        }
        .card-header { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            margin-bottom: 12px; 
            padding-bottom: 10px; 
            border-bottom: 2px solid #4A90A4; 
        }
        .card-title { 
            font-size: 0.95rem; 
            font-weight: 700; 
            color: #2c3e50; 
            text-transform: uppercase; 
            text-align: center;
        }
        
        /* Bidang Pegawai Chart */
        .bidang-chart-container { height: 280px; }
        
        /* Persentase Section - Center Card */
        .persentase-card { padding: 15px; }
        .persentase-container { 
            display: flex; 
            gap: 20px; 
            justify-content: center; 
            align-items: flex-start; 
        }
        .donut-section { 
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .donut-wrapper { 
            position: relative; 
            width: 160px; 
            height: 160px;
        }
        .donut-chart { width: 100% !important; height: 100% !important; }
        .donut-center-text { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            text-align: center; 
            pointer-events: none;
        }
        .donut-center-text .percentage { font-size: 1.3rem; font-weight: 700; color: #5B9A8B; }
        .donut-center-text .label { font-size: 0.7rem; color: #666; display: block; }
        
        /* Donut Legend */
        .donut-legend { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 5px 12px; 
            margin-top: 8px; 
            justify-content: center;
            max-width: 280px;
        }
        .legend-item { display: flex; align-items: center; gap: 4px; font-size: 0.7rem; }
        .legend-color { width: 10px; height: 10px; border-radius: 2px; flex-shrink: 0; }
        .legend-value { font-weight: 600; color: #333; }
        
        /* Keterangan Box */
        .keterangan-box { 
            background: #f8f9fa; 
            border-radius: 8px; 
            padding: 12px 15px; 
            text-align: center;
            min-width: 90px;
        }
        .keterangan-title { font-size: 0.7rem; font-weight: 600; color: #666; margin-bottom: 6px; }
        .keterangan-value { font-size: 1.4rem; font-weight: 700; color: #dc3545; }
        .keterangan-percent { font-size: 0.75rem; color: #999; }
        
        /* Pembinaan Section */
        .pembinaan-chart-container { height: 280px; }
        .pembinaan-legend { 
            display: flex; 
            flex-direction: column; 
            gap: 5px; 
            margin-bottom: 12px;
            font-size: 0.8rem;
        }
        .pembinaan-legend-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            padding: 2px 0;
        }
        .pembinaan-legend-item .label { color: #666; }
        .pembinaan-legend-item .value { 
            font-weight: 600; 
            padding: 3px 10px; 
            border-radius: 4px; 
            font-size: 0.75rem;
        }
        
        /* Bidang Cards Grid - 3 columns */
        .bidang-grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 15px; 
            margin-bottom: 15px; 
        }
        
        .bidang-card { 
            background: white; 
            border-radius: 12px; 
            padding: 18px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); 
            border: 1px solid #eee;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .bidang-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        .bidang-card-header { 
            font-size: 0.95rem; 
            font-weight: 600; 
            color: #2c3e50; 
            margin-bottom: 15px; 
            text-align: center; 
            border-bottom: 2px solid #4A90A4; 
            padding-bottom: 10px; 
            letter-spacing: 0.5px;
        }
        
        /* Bidang Stats - Horizontal Bar Layout */
        .bidang-stats-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }
        .bidang-stat-item {
            display: flex;
            align-items: center;
            width: 100%;
        }
        .bidang-stat-item .stat-label { 
            color: #555; 
            font-weight: 600;
            font-size: 0.7rem;
            min-width: 90px;
            text-align: right;
            padding-right: 10px;
        }
        .bidang-stat-item .stat-bar {
            flex: 1;
            height: 18px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            display: flex;
            align-items: center;
        }
        .bidang-stat-item .stat-bar-fill {
            height: 100%;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 6px;
            font-size: 0.65rem;
            font-weight: 700;
            color: white;
            min-width: fit-content;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
        }
        
        .bidang-chart { height: 120px; margin-top: 10px; }
        
        /* Bidang Data Table */
        .bidang-data-table {
            margin-top: 12px;
            border-collapse: collapse;
            width: 100%;
            font-size: 0.7rem;
            border-radius: 6px;
            overflow: hidden;
        }
        .bidang-data-table th {
            background: #4A5568;
            color: white;
            padding: 8px 4px;
            text-align: center;
            font-weight: 500;
            border: none;
            font-size: 0.65rem;
        }
        .bidang-data-table td {
            padding: 8px 4px;
            text-align: center;
            border: 1px solid #eee;
            font-weight: 600;
            background: #fafafa;
        }
        .bidang-data-table .row-label {
            background: #f0f0f0;
            font-weight: 700;
            color: #2c3e50;
        }
        
        /* Footer */
        .footer { 
            text-align: center; 
            margin-top: 25px; 
            padding: 20px; 
            color: #666; 
            font-size: 0.8rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        /* Responsive */
        @media (max-width: 1400px) { 
            .main-grid { grid-template-columns: 1fr 1.5fr 1fr; }
        }
        @media (max-width: 1200px) { 
            .bidang-grid { grid-template-columns: repeat(2, 1fr); } 
            .main-grid { grid-template-columns: 1fr; }
            .top-summary { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) { 
            body { padding: 10px; }
            .dashboard-title { font-size: 1.5rem; }
            .top-summary { grid-template-columns: 1fr; }
            .summary-card { justify-content: flex-start; }
            .bidang-grid { grid-template-columns: 1fr; }
            .persentase-container { flex-direction: column; align-items: center; }
            .filter-section { flex-direction: column; align-items: stretch; }
        }
        
        /* Color utilities - muted professional palette */
        .bg-wfo { background: #5B9A8B; }
        .bg-dinas { background: #5B8DB8; }
        .bg-undangan { background: #8B7B9B; }
        .bg-sakit { background: #C1946A; }
        .bg-ijin { background: #6B9A8B; }
        .bg-cuti { background: #D4A76A; color: white !important; }
        .bg-tidak-absen { background: #C17B7B; }
        
        /* Bidang specific colors - muted professional palette */
        .bidang-tu .stat-bar-fill { background: #C1946A !important; color: white !important; }
        .bidang-tu .bidang-card-header { border-bottom-color: #C1946A; }
        .bidang-pidsus .stat-bar-fill { background: #8B7B9B !important; color: white !important; }
        .bidang-pidsus .bidang-card-header { border-bottom-color: #8B7B9B; }
        .bidang-pidum .stat-bar-fill { background: #5B8DB8 !important; color: white !important; }
        .bidang-pidum .bidang-card-header { border-bottom-color: #5B8DB8; }
        .bidang-intel .stat-bar-fill { background: #C17B7B !important; color: white !important; }
        .bidang-intel .bidang-card-header { border-bottom-color: #C17B7B; }
        .bidang-was .stat-bar-fill { background: #D4A76A !important; color: white !important; }
        .bidang-was .bidang-card-header { border-bottom-color: #D4A76A; }
        .bidang-datun .stat-bar-fill { background: #5B9A8B !important; color: white !important; }
        .bidang-datun .bidang-card-header { border-bottom-color: #5B9A8B; }
        .bidang-aset .stat-bar-fill { background: #6B9A6B !important; color: white !important; }
        .bidang-aset .bidang-card-header { border-bottom-color: #6B9A6B; }
        .bidang-kor .stat-bar-fill { background: #7C9CB5 !important; color: white !important; }
        .bidang-kor .bidang-card-header { border-bottom-color: #7C9CB5; }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Dashboard Title -->
        <h1 class="dashboard-title" id="dashboardTitle">DASHBOARD ABSENSI DESEMBER 2025</h1>
        
        <!-- Top Summary Cards -->
        <div class="top-summary">
            <div class="summary-card pegawai">
                <span class="card-label">Total<br>Pegawai</span>
                <span class="card-value" id="statPegawai">142</span>
                <span class="card-icon">üë•</span>
            </div>
            <div class="summary-card hari-kerja">
                <span class="card-label">Hari<br>Kerja</span>
                <span class="card-value" id="statHariKerja">21</span>
                <span class="card-icon">üìÖ</span>
            </div>
            <div class="summary-card check-in">
                <span class="card-label">Check<br>In</span>
                <span class="card-value"><span id="statCheckIn">2,965</span>/<span id="statTotalCheckIn">2,982</span></span>
                <span class="card-icon">‚úÖ</span>
            </div>
            <div class="summary-card bidang">
                <span class="card-label">Total<br>Bidang</span>
                <span class="card-value" id="statBidang">9</span>
                <span class="card-icon">üè¢</span>
            </div>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <div class="filter-group">
                <label for="bulanFilter">üìÖ Pilih Bulan:</label>
                <select id="bulanFilter" onchange="updateChart()">
                    <option value="januari">Januari</option>
                    <option value="februari">Februari</option>
                    <option value="maret">Maret</option>
                    <option value="april">April</option>
                    <option value="mei">Mei</option>
                    <option value="juni">Juni</option>
                    <option value="juli">Juli</option>
                    <option value="agustus">Agustus</option>
                    <option value="september">September</option>
                    <option value="oktober">Oktober</option>
                    <option value="november">November</option>
                    <option value="desember" selected>Desember</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="tahunFilter">üìÜ Pilih Tahun:</label>
                <select id="tahunFilter" onchange="updateChart()">
                    <option value="2025" selected>2025</option>
                    <option value="2026">2026</option>
                </select>
            </div>
        </div>

        <!-- Main Content - 3 Column Grid -->
        <div class="main-grid">
            <!-- Bidang Pegawai Card -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Bidang Pegawai</span>
                </div>
                <div class="bidang-chart-container">
                    <canvas id="bidangChart"></canvas>
                </div>
            </div>
            
            <!-- Persentase Kehadiran Card (Center) -->
            <div class="card persentase-card">
                <div class="card-header">
                    <span class="card-title">Persentase Kehadiran Keseluruhan</span>
                </div>
                <div class="persentase-container">
                    <!-- Left Donut - Categories -->
                    <div class="donut-section">
                        <div class="donut-wrapper">
                            <canvas id="kehadiranDonutChart" class="donut-chart"></canvas>
                        </div>
                        <div class="donut-legend" id="kehadiranLegend">
                            <div class="legend-item"><div class="legend-color bg-wfo"></div><span>WFO</span><span class="legend-value" id="leg-wfo">78.0%</span></div>
                            <div class="legend-item"><div class="legend-color bg-dinas"></div><span>DINAS LUAR</span><span class="legend-value" id="leg-dinas">14.8%</span></div>
                            <div class="legend-item"><div class="legend-color bg-undangan"></div><span>UNDANGAN</span><span class="legend-value" id="leg-undangan">2.5%</span></div>
                            <div class="legend-item"><div class="legend-color bg-sakit"></div><span>SAKIT</span><span class="legend-value" id="leg-sakit">0.6%</span></div>
                            <div class="legend-item"><div class="legend-color bg-ijin"></div><span>IJIN</span><span class="legend-value" id="leg-ijin">0.0%</span></div>
                            <div class="legend-item"><div class="legend-color bg-cuti"></div><span>CUTI</span><span class="legend-value" id="leg-cuti">3.6%</span></div>
                            <div class="legend-item"><div class="legend-color bg-tidak-absen"></div><span>TIDAK ABSEN</span><span class="legend-value" id="leg-tidakabsen">0.0%</span></div>
                        </div>
                    </div>
                    
                    <!-- Right Donut - Absen Percentage -->
                    <div class="donut-section">
                        <div class="donut-wrapper">
                            <canvas id="absenDonutChart" class="donut-chart"></canvas>
                            <div class="donut-center-text">
                                <span class="percentage" id="absenPercent">99.43%</span>
                                <span class="label">Absen</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Keterangan Box -->
                    <div class="keterangan-box">
                        <div class="keterangan-title">Tanpa<br>Keterangan</div>
                        <div class="keterangan-value" id="tanpaKeteranganValue">0</div>
                        <div class="keterangan-percent" id="tanpaKeteranganPersen">0.57%</div>
                    </div>
                </div>
            </div>
            
            <!-- Pembinaan Card (Right) -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title">Pembinaan</span>
                </div>
                <div class="pembinaan-legend" id="pembinaanLegend">
                    <div class="pembinaan-legend-item"><span class="label">TIDAK ABSEN</span><span class="value bg-tidak-absen">0.00%</span></div>
                    <div class="pembinaan-legend-item"><span class="label">SAKIT</span><span class="value bg-sakit">0.19%</span></div>
                    <div class="pembinaan-legend-item"><span class="label">UNDANGAN</span><span class="value bg-undangan">0.58%</span></div>
                    <div class="pembinaan-legend-item"><span class="label">DINAS LUAR</span><span class="value bg-dinas">5.77%</span></div>
                </div>
                <div class="pembinaan-chart-container">
                    <canvas id="pembinaanChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Ringkasan Kehadiran Per Kategori -->
        <div class="card" style="margin-bottom: 20px;">
            <div class="card-header">
                <span class="card-title">Ringkasan Kehadiran Per Kategori</span>
            </div>
            <div style="height: 220px;">
                <canvas id="ringkasanChart"></canvas>
            </div>
        </div>

        <!-- Bidang Cards Grid -->
        <div class="bidang-grid">
            <!-- Tata Usaha -->
            <div class="bidang-card bidang-tu">
                <div class="bidang-card-header">Tata Usaha</div>
                <div class="bidang-stats-row">
                    <div class="bidang-stat-item">
                        <span class="stat-label">TIDAK ABSEN</span>
                        <div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="tu-tidakabsen-bar" style="width: 0%">0.00%</div></div>
                    </div>
                </div>
                <div class="bidang-stats-row">
                    <div class="bidang-stat-item">
                        <span class="stat-label">CUTI</span>
                        <div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="tu-cuti-bar" style="width: 6.94%">6.94%</div></div>
                    </div>
                </div>
                <div class="bidang-stats-row">
                    <div class="bidang-stat-item">
                        <span class="stat-label">IJIN</span>
                        <div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="tu-ijin-bar" style="width: 0%">0.00%</div></div>
                    </div>
                </div>
                <div class="bidang-stats-row">
                    <div class="bidang-stat-item">
                        <span class="stat-label">SAKIT</span>
                        <div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="tu-sakit-bar" style="width: 0.46%">0.46%</div></div>
                    </div>
                </div>
                <div class="bidang-stats-row">
                    <div class="bidang-stat-item">
                        <span class="stat-label">UNDANGAN</span>
                        <div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="tu-undangan-bar" style="width: 1.32%">1.32%</div></div>
                    </div>
                </div>
                <div class="bidang-stats-row">
                    <div class="bidang-stat-item">
                        <span class="stat-label">DINAS LUAR</span>
                        <div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="tu-dinas-bar" style="width: 5.79%">5.79%</div></div>
                    </div>
                </div>
                <div class="bidang-stats-row">
                    <div class="bidang-stat-item">
                        <span class="stat-label">WFO</span>
                        <div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="tu-wfo-bar" style="width: 83.33%">83.33%</div></div>
                    </div>
                </div>
                <div class="bidang-chart"><canvas id="chart-tu"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="tu-wfo-val">361</td><td id="tu-dinas-val">25</td><td id="tu-und-val">6</td><td id="tu-sakit-val">2</td><td id="tu-ijin-val">0</td><td id="tu-cuti-val">30</td><td id="tu-ta-val">0</td></tr>
                </table>
            </div>
            
            <!-- Tindak Pidana Khusus -->
            <div class="bidang-card bidang-pidsus">
                <div class="bidang-card-header">Tindak Pidana Khusus</div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">TIDAK ABSEN</span><div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="pidsus-tidakabsen-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">CUTI</span><div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="pidsus-cuti-bar" style="width: 5.24%">5.24%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">IJIN</span><div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="pidsus-ijin-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">SAKIT</span><div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="pidsus-sakit-bar" style="width: 0.67%">0.67%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">UNDANGAN</span><div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="pidsus-undangan-bar" style="width: 2.38%">2.38%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">DINAS LUAR</span><div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="pidsus-dinas-bar" style="width: 17.8%">17.80%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">WFO</span><div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="pidsus-wfo-bar" style="width: 74%">74.00%</div></div></div></div>
                <div class="bidang-chart"><canvas id="chart-pidsus"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="pidsus-wfo-val">311</td><td id="pidsus-dinas-val">75</td><td id="pidsus-und-val">10</td><td id="pidsus-sakit-val">2</td><td id="pidsus-ijin-val">0</td><td id="pidsus-cuti-val">22</td><td id="pidsus-ta-val">0</td></tr>
                </table>
            </div>
            
            <!-- Tindak Pidana Umum -->
            <div class="bidang-card bidang-pidum">
                <div class="bidang-card-header">Tindak Pidana Umum</div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">TIDAK ABSEN</span><div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="pidum-tidakabsen-bar" style="width: 1.7%">1.70%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">CUTI</span><div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="pidum-cuti-bar" style="width: 2.01%">2.01%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">IJIN</span><div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="pidum-ijin-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">SAKIT</span><div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="pidum-sakit-bar" style="width: 0.75%">0.75%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">UNDANGAN</span><div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="pidum-undangan-bar" style="width: 4.05%">4.05%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">DINAS LUAR</span><div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="pidum-dinas-bar" style="width: 14%">14.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">WFO</span><div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="pidum-wfo-bar" style="width: 77.5%">77.50%</div></div></div></div>
                <div class="bidang-chart"><canvas id="chart-pidum"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="pidum-wfo-val">260</td><td id="pidum-dinas-val">96</td><td id="pidum-und-val">17</td><td id="pidum-sakit-val">3</td><td id="pidum-ijin-val">0</td><td id="pidum-cuti-val">8</td><td id="pidum-ta-val">15</td></tr>
                </table>
            </div>
            
            <!-- Intelijen -->
            <div class="bidang-card bidang-intel">
                <div class="bidang-card-header">Intelijen</div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">TIDAK ABSEN</span><div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="intel-tidakabsen-bar" style="width: 0.52%">0.52%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">CUTI</span><div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="intel-cuti-bar" style="width: 3.17%">3.17%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">IJIN</span><div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="intel-ijin-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">SAKIT</span><div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="intel-sakit-bar" style="width: 0.51%">0.51%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">UNDANGAN</span><div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="intel-undangan-bar" style="width: 4.49%">4.49%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">DINAS LUAR</span><div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="intel-dinas-bar" style="width: 14.7%">14.70%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">WFO</span><div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="intel-wfo-bar" style="width: 76.5%">76.50%</div></div></div></div>
                <div class="bidang-chart"><canvas id="chart-intel"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="intel-wfo-val">241</td><td id="intel-dinas-val">40</td><td id="intel-und-val">21</td><td id="intel-sakit-val">2</td><td id="intel-ijin-val">0</td><td id="intel-cuti-val">11</td><td id="intel-ta-val">0</td></tr>
                </table>
            </div>
            
            <!-- Pengawasan -->
            <div class="bidang-card bidang-was">
                <div class="bidang-card-header">Pengawasan</div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">TIDAK ABSEN</span><div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="was-tidakabsen-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">CUTI</span><div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="was-cuti-bar" style="width: 6.41%">6.41%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">IJIN</span><div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="was-ijin-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">SAKIT</span><div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="was-sakit-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">UNDANGAN</span><div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="was-undangan-bar" style="width: 3.87%">3.87%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">DINAS LUAR</span><div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="was-dinas-bar" style="width: 20.6%">20.60%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">WFO</span><div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="was-wfo-bar" style="width: 61.17%">61.17%</div></div></div></div>
                <div class="bidang-chart"><canvas id="chart-was"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="was-wfo-val">192</td><td id="was-dinas-val">65</td><td id="was-und-val">12</td><td id="was-sakit-val">0</td><td id="was-ijin-val">0</td><td id="was-cuti-val">20</td><td id="was-ta-val">0</td></tr>
                </table>
            </div>
            
            <!-- Perdata dan Tata Usaha Negara -->
            <div class="bidang-card bidang-datun">
                <div class="bidang-card-header">Perdata dan Tata Usaha Negara</div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">TIDAK ABSEN</span><div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="datun-tidakabsen-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">CUTI</span><div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="datun-cuti-bar" style="width: 3.79%">3.79%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">IJIN</span><div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="datun-ijin-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">SAKIT</span><div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="datun-sakit-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">UNDANGAN</span><div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="datun-undangan-bar" style="width: 1.19%">1.19%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">DINAS LUAR</span><div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="datun-dinas-bar" style="width: 17.26%">17.26%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">WFO</span><div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="datun-wfo-bar" style="width: 78.06%">78.06%</div></div></div></div>
                <div class="bidang-chart"><canvas id="chart-datun"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="datun-wfo-val">134</td><td id="datun-dinas-val">29</td><td id="datun-und-val">2</td><td id="datun-sakit-val">0</td><td id="datun-ijin-val">0</td><td id="datun-cuti-val">3</td><td id="datun-ta-val">0</td></tr>
                </table>
            </div>
            
            <!-- Pemulihan Aset -->
            <div class="bidang-card bidang-aset">
                <div class="bidang-card-header">Pemulihan Aset</div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">TIDAK ABSEN</span><div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="aset-tidakabsen-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">CUTI</span><div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="aset-cuti-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">IJIN</span><div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="aset-ijin-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">SAKIT</span><div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="aset-sakit-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">UNDANGAN</span><div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="aset-undangan-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">DINAS LUAR</span><div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="aset-dinas-bar" style="width: 39.05%">39.05%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">WFO</span><div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="aset-wfo-bar" style="width: 60.95%">60.95%</div></div></div></div>
                <div class="bidang-chart"><canvas id="chart-aset"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="aset-wfo-val">64</td><td id="aset-dinas-val">41</td><td id="aset-und-val">0</td><td id="aset-sakit-val">0</td><td id="aset-ijin-val">0</td><td id="aset-cuti-val">0</td><td id="aset-ta-val">0</td></tr>
                </table>
            </div>
            
            <!-- Koordinator -->
            <div class="bidang-card bidang-kor">
                <div class="bidang-card-header">Koordinator</div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">TIDAK ABSEN</span><div class="stat-bar"><div class="stat-bar-fill bg-tidak-absen" id="kor-tidakabsen-bar" style="width: 1.19%">1.19%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">CUTI</span><div class="stat-bar"><div class="stat-bar-fill bg-cuti" id="kor-cuti-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">IJIN</span><div class="stat-bar"><div class="stat-bar-fill bg-ijin" id="kor-ijin-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">SAKIT</span><div class="stat-bar"><div class="stat-bar-fill bg-sakit" id="kor-sakit-bar" style="width: 0%">0.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">UNDANGAN</span><div class="stat-bar"><div class="stat-bar-fill bg-undangan" id="kor-undangan-bar" style="width: 1.19%">1.19%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">DINAS LUAR</span><div class="stat-bar"><div class="stat-bar-fill bg-dinas" id="kor-dinas-bar" style="width: 30%">30.00%</div></div></div></div>
                <div class="bidang-stats-row"><div class="bidang-stat-item"><span class="stat-label">WFO</span><div class="stat-bar"><div class="stat-bar-fill bg-wfo" id="kor-wfo-bar" style="width: 65%">65.00%</div></div></div></div>
                <div class="bidang-chart"><canvas id="chart-kor"></canvas></div>
                <table class="bidang-data-table">
                    <tr><th></th><th>WFO</th><th>DINAS<br>LUAR</th><th>UNDANGA<br>N</th><th>SAKIT</th><th>IJIN</th><th>CUTI</th><th>TIDAK<br>ABSEN</th></tr>
                    <tr><td class="row-label">Jumlah</td><td id="kor-wfo-val">66</td><td id="kor-dinas-val">16</td><td id="kor-und-val">1</td><td id="kor-sakit-val">0</td><td id="kor-ijin-val">0</td><td id="kor-cuti-val">0</td><td id="kor-ta-val">1</td></tr>
                </table>
            </div>
        </div>

        <div class="footer">
            <p>¬© 2025 Kejaksaan Tinggi Kepulauan Riau</p>
        </div>
    </div>

    <script>
        // DATA ABSENSI - Diorganisir per TAHUN dan BULAN
        const dataAbsensi = {
            2025: {
                mei: { totalPegawai: 122, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Libur','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Libur','Libur','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Libur','Libur','Sabtu'], isWeekend: [true,false,true,true,false,false,false,false,false,true,true,true,true,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,true,true,true], wfo: [0,92,0,0,98,97,96,88,92,0,0,0,0,92,95,81,0,0,92,91,98,92,101,0,0,104,101,100,0,0,0], dinasLuar: [0,8,0,0,6,6,10,15,10,0,0,0,0,12,12,15,0,0,12,15,8,16,6,0,0,1,1,3,0,0,0], undangan: [0,8,0,0,3,4,2,4,4,0,0,0,0,5,2,13,0,0,4,4,4,2,3,0,0,2,5,4,0,0,0], sakit: [0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0], ijin: [0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [0,1,0,0,4,4,4,4,5,0,0,0,0,2,2,2,0,0,2,2,1,1,1,0,0,3,3,3,0,0,0], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                juni: { totalPegawai: 149, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30], hari: ['Minggu','Senin','Selasa','Rabu','Kamis','Libur','Sabtu','Minggu','Libur','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Libur','Sabtu','Minggu','Senin'], isWeekend: [true,false,false,false,false,true,true,true,true,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,true,true,true,false], wfo: [0,100,103,106,117,0,0,0,0,123,126,125,126,0,0,117,118,114,107,106,0,0,122,119,105,110,0,0,0,122], dinasLuar: [0,6,4,5,1,0,0,0,0,3,2,0,3,0,0,9,8,17,21,23,0,0,5,8,13,12,0,0,0,10], undangan: [0,4,3,2,7,0,0,0,0,6,5,5,3,0,0,2,5,5,6,8,0,0,2,4,10,10,0,0,0,1], sakit: [0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,2,1,0,1,0,0,0,1,0,2,1,0,0,0,0], ijin: [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1], cuti: [0,5,5,6,7,0,0,0,0,5,5,5,5,0,0,4,4,1,2,2,0,0,6,6,6,6,0,0,0,3], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                juli: { totalPegawai: 151, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis'], isWeekend: [false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false], wfo: [120,115,107,112,0,0,120,113,123,125,118,0,0,122,126,125,128,133,0,0,126,127,122,121,117,0,0,130,119,128,125], dinasLuar: [9,11,18,11,0,0,5,11,1,4,5,0,0,5,9,8,4,2,0,0,0,0,2,7,7,0,0,7,7,2,0], undangan: [1,3,6,7,0,0,2,3,4,4,9,0,0,7,1,4,4,1,0,0,2,3,3,2,1,0,0,1,1,8,2], sakit: [0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0], ijin: [0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0], cuti: [4,4,3,3,0,0,6,6,6,4,4,0,0,2,0,0,0,0,0,0,1,1,2,1,1,0,0,1,1,1,1], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                agustus: { totalPegawai: 142, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Libur','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu'], isWeekend: [false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,true,false,false,false,false,true,true,false,false,false,false,false,true,true], wfo: [121,0,0,108,111,117,99,115,0,0,115,125,126,111,109,0,0,0,123,109,112,111,0,0,119,124,117,105,118,0,0], dinasLuar: [5,0,0,26,23,17,35,19,0,0,17,9,8,23,23,0,0,0,11,25,24,25,0,0,15,10,17,29,17,0,0], undangan: [4,0,0,5,5,4,3,1,0,0,3,2,1,2,3,0,0,0,2,2,2,3,0,0,1,3,3,5,5,0,0], sakit: [2,0,0,2,2,2,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,1,1,0,2,2,0,0], ijin: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [3,0,0,4,4,4,4,4,0,0,7,6,6,6,6,0,0,0,6,6,6,6,0,0,6,4,4,4,4,0,0], tidakAbsen: [7,0,0,5,5,6,9,9,0,0,8,8,9,8,6,0,0,0,8,8,6,4,0,0,8,8,9,5,4,0,0] },
                september: { totalPegawai: 150, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30], hari: ['Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa'], isWeekend: [false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false], wfo: [138,134,128,123,0,0,0,108,108,108,105,104,0,0,96,98,101,89,121,0,0,97,91,108,117,124,0,0,117,113], dinasLuar: [0,0,10,11,0,0,0,20,18,13,21,21,0,0,35,38,33,47,16,0,0,35,36,18,19,11,0,0,18,21], undangan: [1,4,1,3,0,0,0,0,2,8,6,4,0,0,2,1,3,1,0,0,0,6,11,13,1,1,0,0,3,4], sakit: [0,1,0,0,0,0,0,3,3,2,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1], ijin: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0], cuti: [3,3,3,5,0,0,0,11,10,10,9,11,0,0,7,4,4,4,4,0,0,3,2,2,3,4,0,0,3,2], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                oktober: { totalPegawai: 147, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat'], isWeekend: [false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false], wfo: [113,105,102,0,0,110,109,110,103,106,0,0,121,127,125,105,101,0,0,132,128,124,119,119,0,0,127,127,109,107,125], dinasLuar: [21,29,29,0,0,22,25,25,34,30,0,0,15,9,10,29,30,0,0,0,4,8,16,16,0,0,5,5,23,24,2], undangan: [3,3,4,0,0,3,1,2,0,0,0,0,1,1,2,1,4,0,0,3,3,3,0,0,0,0,2,2,2,4,5], sakit: [0,0,2,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1], ijin: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1], cuti: [2,2,2,0,0,3,3,2,2,2,0,0,2,2,2,4,4,0,0,4,4,4,4,4,0,0,4,4,4,4,5], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                november: { totalPegawai: 143, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30], hari: ['Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu'], isWeekend: [true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true], wfo: [0,0,124,119,106,100,105,0,0,120,122,111,106,107,0,0,120,128,109,92,99,0,0,110,113,107,81,92,0,0], dinasLuar: [0,0,13,17,26,36,29,0,0,13,19,23,30,26,0,0,14,8,25,44,35,0,0,25,19,28,50,44,0,0], undangan: [0,0,0,2,5,1,3,0,0,3,0,3,2,4,0,0,3,1,3,1,3,0,0,2,4,2,1,1,0,0], sakit: [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,0,4,2,0,0], ijin: [0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [0,0,2,2,3,3,3,0,0,4,2,2,2,2,0,0,3,2,2,2,1,0,0,2,2,2,2,2,0,0], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] },
                desember: { totalPegawai: 142, labels: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], hari: ['Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu','Senin','Selasa','Rabu','Libur','Libur','Sabtu','Minggu','Senin','Selasa','Rabu'], isWeekend: [false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,true,true,true,true,false,false,false], wfo: [121,117,121,124,124,0,0,121,118,94,96,97,0,0,60,56,124,105,101,0,0,111,113,111,0,0,0,0,126,125,119], dinasLuar: [11,17,18,10,11,0,0,9,14,36,36,31,0,0,72,75,9,18,16,0,0,2,0,2,0,0,0,0,0,0,6], undangan: [8,5,1,4,4,0,0,5,3,5,2,5,0,0,6,5,3,5,4,0,0,3,1,2,0,0,0,0,1,1,1], sakit: [0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,2,0,2,4,0,0,1,1,1,0,0,0,0,1,2,0], ijin: [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], cuti: [2,2,2,3,3,0,0,6,5,6,7,9,0,0,4,4,6,11,17,0,0,25,25,26,0,0,0,0,14,14,14], tidakAbsen: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] }
            },
            2026: { }
        };

        // Data Bidang Pegawai - muted professional colors
        const dataBidang = {
            labels: ['Pembinaan', 'Tata Usaha', 'Pidsus', 'Pidum', 'Pengawasan', 'Intel', 'Datun', 'Koordinator'],
            data: [33, 22, 19, 18, 15, 15, 12, 8],
            colors: ['#5B8DB8', '#C1946A', '#C17B7B', '#8B7B9B', '#5B9A8B', '#D4A76A', '#6B9A6B', '#7C9CB5']
        };

        const bulanNama = { januari: 'JANUARI', februari: 'FEBRUARI', maret: 'MARET', april: 'APRIL', mei: 'MEI', juni: 'JUNI', juli: 'JULI', agustus: 'AGUSTUS', september: 'SEPTEMBER', oktober: 'OKTOBER', november: 'NOVEMBER', desember: 'DESEMBER' };

        let bidangChartInstance, kehadiranDonutInstance, absenDonutInstance, pembinaanChartInstance, ringkasanChartInstance;
        let bidangCharts = {};

        function getSelectedData() { 
            const bulan = document.getElementById('bulanFilter').value; 
            const tahun = document.getElementById('tahunFilter').value; 
            if (dataAbsensi[tahun] && dataAbsensi[tahun][bulan]) { 
                return dataAbsensi[tahun][bulan]; 
            } 
            return null; 
        }

        function initCharts() {
            initBidangChart();
            initKehadiranDonutChart();
            initAbsenDonutChart();
            initPembinaanChart();
            initRingkasanChart();
            initBidangSmallCharts();
            updateStats();
        }
        
        function initBidangChart() {
            const ctx = document.getElementById('bidangChart').getContext('2d');
            bidangChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: dataBidang.labels,
                    datasets: [{
                        data: dataBidang.data,
                        backgroundColor: dataBidang.colors,
                        borderRadius: 4,
                        barThickness: 22
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'end',
                            color: '#333',
                            font: { size: 10, weight: '600' },
                            formatter: (value) => value
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, grid: { display: false }, max: 40 },
                        y: { grid: { display: false }, ticks: { font: { size: 10 } } }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
        
        function initKehadiranDonutChart() {
            const ctx = document.getElementById('kehadiranDonutChart').getContext('2d');
            const data = getSelectedData() || dataAbsensi[2025].desember;
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            kehadiranDonutInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['WFO', 'Dinas Luar', 'Undangan', 'Sakit', 'Ijin', 'Cuti', 'Tidak Absen'],
                    datasets: [{
                        data: [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)],
                        backgroundColor: ['#5B9A8B', '#5B8DB8', '#8B7B9B', '#C1946A', '#6B9A8B', '#D4A76A', '#C17B7B'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    cutout: '60%',
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            color: '#fff',
                            font: { size: 9, weight: 'bold' },
                            formatter: (value, ctx) => {
                                const total = ctx.dataset.data.reduce((a, b) => a + b, 0);
                                const pct = ((value / total) * 100).toFixed(1);
                                return pct > 3 ? pct + '%' : '';
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
            updateLegendValues(data);
        }
        
        function updateLegendValues(data) {
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            const total = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan) + sum(data.sakit) + sum(data.ijin) + sum(data.cuti) + sum(data.tidakAbsen);
            
            document.getElementById('leg-wfo').textContent = ((sum(data.wfo) / total) * 100).toFixed(1) + '%';
            document.getElementById('leg-dinas').textContent = ((sum(data.dinasLuar) / total) * 100).toFixed(1) + '%';
            document.getElementById('leg-undangan').textContent = ((sum(data.undangan) / total) * 100).toFixed(1) + '%';
            document.getElementById('leg-sakit').textContent = ((sum(data.sakit) / total) * 100).toFixed(1) + '%';
            document.getElementById('leg-ijin').textContent = ((sum(data.ijin) / total) * 100).toFixed(1) + '%';
            document.getElementById('leg-cuti').textContent = ((sum(data.cuti) / total) * 100).toFixed(1) + '%';
            document.getElementById('leg-tidakabsen').textContent = ((sum(data.tidakAbsen) / total) * 100).toFixed(1) + '%';
        }
        
        function initAbsenDonutChart() {
            const ctx = document.getElementById('absenDonutChart').getContext('2d');
            const data = getSelectedData() || dataAbsensi[2025].desember;
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            const totalAbsen = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan);
            const totalTidakAbsen = sum(data.sakit) + sum(data.ijin) + sum(data.cuti) + sum(data.tidakAbsen);
            const total = totalAbsen + totalTidakAbsen;
            const absenPct = ((totalAbsen / total) * 100).toFixed(2);
            
            document.getElementById('absenPercent').textContent = absenPct + '%';
            document.getElementById('tanpaKeteranganValue').textContent = sum(data.tidakAbsen);
            document.getElementById('tanpaKeteranganPersen').textContent = ((sum(data.tidakAbsen) / total) * 100).toFixed(2) + '%';
            
            absenDonutInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Absen', 'Tidak Absen'],
                    datasets: [{
                        data: [totalAbsen, totalTidakAbsen],
                        backgroundColor: ['#5B9A8B', '#e9ecef'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    cutout: '70%',
                    plugins: { legend: { display: false }, datalabels: { display: false } }
                }
            });
        }
        
        function initPembinaanChart() {
            const ctx = document.getElementById('pembinaanChart').getContext('2d');
            const data = getSelectedData() || dataAbsensi[2025].desember;
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            pembinaanChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['WFO', 'DL', 'UND', 'SAKIT', 'IJIN', 'CUTI', 'TA'],
                    datasets: [{
                        label: 'Jumlah',
                        data: [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)],
                        backgroundColor: ['#5B9A8B', '#5B8DB8', '#8B7B9B', '#C1946A', '#6B9A8B', '#D4A76A', '#C17B7B'],
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'end',
                            color: '#333',
                            font: { size: 9 }
                        }
                    },
                    scales: {
                        x: { beginAtZero: true, grid: { display: false } },
                        y: { grid: { display: false }, ticks: { font: { size: 9 } } }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
        
        function initRingkasanChart() {
            const ctx = document.getElementById('ringkasanChart').getContext('2d');
            const data = getSelectedData() || dataAbsensi[2025].desember;
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            ringkasanChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['WFO', 'Dinas Luar', 'Undangan', 'Sakit', 'Ijin', 'Cuti', 'Tidak Absen'],
                    datasets: [{
                        label: 'Jumlah',
                        data: [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)],
                        backgroundColor: ['#5B9A8B', '#5B8DB8', '#8B7B9B', '#C1946A', '#6B9A8B', '#D4A76A', '#C17B7B'],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            color: '#333',
                            font: { size: 10, weight: 'bold' }
                        }
                    },
                    scales: {
                        x: { grid: { display: false } },
                        y: { beginAtZero: true, grid: { color: '#f0f0f0' } }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
        
        function initBidangSmallCharts() {
            const bidangIds = ['tu', 'pidsus', 'pidum', 'intel', 'was', 'datun', 'aset', 'kor'];
            
            bidangIds.forEach((id) => {
                const ctx = document.getElementById(`chart-${id}`);
                if (ctx) {
                    bidangCharts[id] = new Chart(ctx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['WFO', 'DL', 'UND', 'S', 'I', 'C', 'TA'],
                            datasets: [{
                                data: [80, 15, 3, 1, 0, 3, 0],
                                backgroundColor: ['#5B9A8B', '#5B8DB8', '#8B7B9B', '#C1946A', '#6B9A8B', '#D4A76A', '#C17B7B'],
                                borderRadius: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false }, datalabels: { display: false } },
                            scales: {
                                x: { grid: { display: false }, ticks: { font: { size: 7 } } },
                                y: { beginAtZero: true, grid: { color: '#f0f0f0' }, ticks: { font: { size: 7 } } }
                            }
                        }
                    });
                }
            });
        }

        function updateChart() {
            const bulan = document.getElementById('bulanFilter').value;
            const tahun = document.getElementById('tahunFilter').value;
            const data = getSelectedData();
            
            // Update title
            document.getElementById('dashboardTitle').textContent = 'DASHBOARD ABSENSI ' + bulanNama[bulan] + ' ' + tahun;
            
            if (!data) {
                updateStatsEmpty();
                return;
            }
            
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            // Update Kehadiran Donut
            if (kehadiranDonutInstance) {
                kehadiranDonutInstance.data.datasets[0].data = [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)];
                kehadiranDonutInstance.update();
                updateLegendValues(data);
            }
            
            // Update Absen Donut
            if (absenDonutInstance) {
                const totalAbsen = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan);
                const totalTidakAbsen = sum(data.sakit) + sum(data.ijin) + sum(data.cuti) + sum(data.tidakAbsen);
                const total = totalAbsen + totalTidakAbsen;
                absenDonutInstance.data.datasets[0].data = [totalAbsen, totalTidakAbsen];
                absenDonutInstance.update();
                document.getElementById('absenPercent').textContent = ((totalAbsen / total) * 100).toFixed(2) + '%';
                document.getElementById('tanpaKeteranganValue').textContent = sum(data.tidakAbsen);
                document.getElementById('tanpaKeteranganPersen').textContent = ((sum(data.tidakAbsen) / total) * 100).toFixed(2) + '%';
            }
            
            // Update Pembinaan Chart
            if (pembinaanChartInstance) {
                pembinaanChartInstance.data.datasets[0].data = [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)];
                pembinaanChartInstance.update();
            }
            
            // Update Ringkasan Chart
            if (ringkasanChartInstance) {
                ringkasanChartInstance.data.datasets[0].data = [sum(data.wfo), sum(data.dinasLuar), sum(data.undangan), sum(data.sakit), sum(data.ijin), sum(data.cuti), sum(data.tidakAbsen)];
                ringkasanChartInstance.update();
            }
            
            updateStats();
        }

        function updateStats() {
            const bulan = document.getElementById('bulanFilter').value;
            const tahun = document.getElementById('tahunFilter').value;
            const data = getSelectedData();
            
            document.getElementById('dashboardTitle').textContent = 'DASHBOARD ABSENSI ' + bulanNama[bulan] + ' ' + tahun;
            
            if (!data) { updateStatsEmpty(); return; }
            const sum = arr => arr.reduce((a, b) => a + b, 0);
            
            document.getElementById('statPegawai').textContent = data.totalPegawai;
            
            const workingDays = data.isWeekend.filter(w => !w).length;
            document.getElementById('statHariKerja').textContent = workingDays;
            
            const totalCheckIn = sum(data.wfo) + sum(data.dinasLuar) + sum(data.undangan);
            const expectedCheckIn = data.totalPegawai * workingDays;
            document.getElementById('statCheckIn').textContent = totalCheckIn.toLocaleString();
            document.getElementById('statTotalCheckIn').textContent = expectedCheckIn.toLocaleString();
        }

        function updateStatsEmpty() {
            document.getElementById('statPegawai').textContent = '-';
            document.getElementById('statHariKerja').textContent = '-';
            document.getElementById('statCheckIn').textContent = '-';
            document.getElementById('statTotalCheckIn').textContent = '-';
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', initCharts);
    </script>
</body>
</html>
